{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Edit Profile - SmartCampus</title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- Favicons -->
    <link href="{% static 'img/favicon.png' %}" rel="icon" />
    <link
      href="{% static 'img/apple-touch-icon.png' %}"
      rel="apple-touch-icon"
    />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap"
      rel="stylesheet"
    />

    <!-- Vendor CSS Files -->
    <link
      href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}"
      rel="stylesheet"
    />
    <link
      href="{% static 'vendor/bootstrap-icons/bootstrap-icons.css' %}"
      rel="stylesheet"
    />
    <link href="{% static 'vendor/aos/aos.css' %}" rel="stylesheet" />

    <!-- Main CSS File -->
    <link href="{% static 'css/main.css' %}" rel="stylesheet" />
  </head>

  <body class="starter-page">
    <header id="header" class="header d-flex align-items-center sticky-top">
      <div
        class="container-fluid container-xl position-relative d-flex align-items-center"
      >
        <a
          href="{% url 'index' %}"
          class="logo d-flex align-items-center me-auto"
        >
          <h1 class="sitename">SmartCampus</h1>
        </a>

        <nav id="navmenu" class="navmenu">
          <ul>
            <li><a href="{% url 'index' %}">Home</a></li>
            <li><a href="{% url 'about' %}">About</a></li>
            <li><a href="{% url 'courses' %}">Courses</a></li>
            <li><a href="{% url 'instructors' %}">Instructors</a></li>
            <li><a href="{% url 'pricing' %}">Pricing</a></li>
            <li><a href="{% url 'blog' %}">Blog</a></li>
            <li><a href="{% url 'contact' %}">Contact</a></li>
          </ul>
          <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
        </nav>

        <div class="dropdown">
          <a
            class="btn-getstarted dropdown-toggle"
            href="#"
            role="button"
            id="userDropdown"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <i class="bi bi-person-circle"></i> {{ user.username }}
          </a>
          <ul
            class="dropdown-menu dropdown-menu-end"
            aria-labelledby="userDropdown"
          >
            <li>
              <a class="dropdown-item" href="{% url 'profile' %}"
                ><i class="bi bi-person"></i> My Profile</a
              >
            </li>
            <li>
              <a class="dropdown-item" href="{% url 'edit_profile' %}"
                ><i class="bi bi-gear"></i> Edit Profile</a
              >
            </li>
            <li><hr class="dropdown-divider" /></li>
            <li>
              <a class="dropdown-item" href="{% url 'logout' %}"
                ><i class="bi bi-box-arrow-right"></i> Logout</a
              >
            </li>
          </ul>
        </div>
      </div>
    </header>

    <main class="main">
      <!-- Page Title -->
      <div class="page-title" data-aos="fade">
        <div class="heading">
          <div class="container">
            <div class="row d-flex justify-content-center text-center">
              <div class="col-lg-8">
                <h1>Edit Profile</h1>
                <p class="mb-0">Update your account information</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- End Page Title -->

      <!-- Edit Profile Section -->
      <section id="edit-profile" class="edit-profile section">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-lg-8">
              <div class="card shadow-sm">
                <div class="card-body p-5">
                  {% if messages %} {% for message in messages %}
                  <div
                    class="alert alert-{{ message.tags }} alert-dismissible fade show"
                    role="alert"
                  >
                    {{ message }}
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="alert"
                      aria-label="Close"
                    ></button>
                  </div>
                  {% endfor %} {% endif %}

                  <form method="post">
                    {% csrf_token %}

                    <h5 class="mb-3">Personal Information</h5>

                    <div class="row">
                      <div class="col-md-6 mb-3">
                        <label for="first_name" class="form-label"
                          >First Name</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          id="first_name"
                          name="first_name"
                          value="{{ user.first_name }}"
                          required
                        />
                      </div>
                      <div class="col-md-6 mb-3">
                        <label for="last_name" class="form-label"
                          >Last Name</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          id="last_name"
                          name="last_name"
                          value="{{ user.last_name }}"
                          required
                        />
                      </div>
                    </div>

                    <div class="mb-3">
                      <label for="username" class="form-label">Username</label>
                      <input
                        type="text"
                        class="form-control"
                        id="username"
                        value="{{ user.username }}"
                        disabled
                      />
                      <small class="text-muted"
                        >Username cannot be changed</small
                      >
                    </div>

                    <div class="mb-4">
                      <label for="email" class="form-label"
                        >Email Address</label
                      >
                      <input
                        type="email"
                        class="form-control"
                        id="email"
                        name="email"
                        value="{{ user.email }}"
                        required
                      />
                    </div>

                    <hr class="my-4" />

                    <h5 class="mb-3">Change Password (Optional)</h5>
                    <p class="text-muted small">
                      Leave blank to keep current password
                    </p>

                    <div class="mb-3">
                      <label for="new_password" class="form-label"
                        >New Password</label
                      >
                      <input
                        type="password"
                        class="form-control"
                        id="new_password"
                        name="new_password"
                        placeholder="Enter new password"
                      />
                    </div>

                    <div class="mb-4">
                      <label for="confirm_password" class="form-label"
                        >Confirm New Password</label
                      >
                      <input
                        type="password"
                        class="form-control"
                        id="confirm_password"
                        name="confirm_password"
                        placeholder="Confirm new password"
                      />
                    </div>

                    <div class="d-flex gap-2">
                      <button type="submit" class="btn btn-primary">
                        Save Changes
                      </button>
                      <a href="{% url 'profile' %}" class="btn btn-secondary"
                        >Cancel</a
                      >
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- /Edit Profile Section -->
    </main>

    <footer id="footer" class="footer position-relative">
      <div class="container copyright text-center mt-4">
        <p>
          Â© <span>Copyright</span>
          <strong class="px-1 sitename">SmartCampus</strong>
          <span>All Rights Reserved</span>
        </p>
      </div>
    </footer>

    <!-- Scroll Top -->
    <a
      href="#"
      id="scroll-top"
      class="scroll-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <!-- Vendor JS Files -->
    <script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'vendor/aos/aos.js' %}"></script>

    <!-- Main JS File -->
    <script src="{% static 'js/main.js' %}"></script>

    <script>
      // Password confirmation validation
      const form = document.querySelector("form");
      const newPassword = document.getElementById("new_password");
      const confirmPassword = document.getElementById("confirm_password");

      form.addEventListener("submit", function (e) {
        if (
          newPassword.value !== confirmPassword.value &&
          newPassword.value !== ""
        ) {
          e.preventDefault();
          alert("Passwords do not match!");
          confirmPassword.focus();
        }
      });
    </script>
  </body>
</html>
